{% extends 'base.html' %}

{% load static %}

{% block js %}
    <script>
        function process(filename, action) {
            if(action != 'edit'){
                    $.ajax({
                    url: '/process/video/' + action + "/",
                    data: {
                        'file_name': filename,
                        'language_code': "en-US"
                    },
                    type: 'POST',
                    success: function () {
                        window.location.reload();
                    },
                    fail: function (error) {
                        alert(error);
                    }
                });
            } else {
                window.location = '/edit/video/' + filename.slice(0, -4)
            }
        }
    </script>
{% endblock %}

{% block content %}
    {{ file_uploaded }}

    {% if error_message %}
        <p> {{ error_message }}</p>
    {%  else %}
    <table class="table">
        <thead>
            <tr>
                <th>File Name</th>
                <th>Locale</th>
                <th>Action</th>
            </tr>
        </thead>
        {% for file in files %}
            <tr>
                <td>{{ file }}</td>
                <td>
                    <select>
                        <option value="en-AU">English (Australia)</option>
                        <option value="en-CA">English (Canada)</option>
                        <option value="en-GH">English (Ghana)</option>
                        <option value="en-GB">English (Great Britain)</option>
                        <option value="en-IN">English (India)</option>
                        <option value="en-IE">English (Ireland)</option>
                        <option value="en-KE">English (Kenya)</option>
                        <option value="en-NZ">English (New Zealand)</option>
                        <option value="en-NG">English (Nigeria)</option>
                        <option value="en-PH">English (Philippines)</option>
                        <option value="en-ZA">English (South Africa)</option>
                        <option value="en-TZ">English (Tanzania)</option>
                        <option value="en-US">English (United States)</option>
                    </select>
                </td>
                <td>{% for action in actions %} <input class="btn btn-info" type="button" value="{{ action.0 }}"  onclick="process('{{ file }}', '{{ action.1 }}')"/>{% endfor %}</td></tr>
        {%  endfor %}
    </table>
    {%  endif %}

    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <input type="file" name="myfile">
        <button type="submit">Upload</button>
    </form>
{% endblock %}


